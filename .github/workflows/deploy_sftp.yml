on:
  push:
    branches: [main]
name: ðŸš€ Deploy React app on push
jobs:
  deploy:
    name: ðŸŽ‰ Deploy React app to production
    runs-on: ubuntu-latest
    steps:
      - name: ðŸšš Get latest code
        uses: actions/checkout@v2.3.2

      - name: ðŸ”§ Use Node.js 12
        uses: actions/setup-node@v2-beta
        with:
          node-version: '14'

      - name: ðŸ”¨ Build React app
        run: |
          yarn install
          yarn build
        env:
          REACT_APP_SPOTIFY_CLIENT_ID: ${{ secrets.SPOTIFY_CLIENT_ID }}

      - name: ðŸ—‚ Upload ftp
        uses: SamKirkland/FTP-Deploy-Action@2.0.0
        env:
          FTP_SERVER: 45.85.219.34
          FTP_USERNAME: ${{ secrets.FTP_USERNAME }}
          FTP_PASSWORD: ${{ secrets.FTP_PASSWORD }}
          METHOD: sftp
          PORT: 22
          LOCAL_DIR: build
          REMOTE_DIR: /var/www/composer
          ARGS: --delete